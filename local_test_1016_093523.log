2024-10-16 09:35:58,030 - INFO - Loading /tmp/X_y_group_train_local_test_alldata_earlystop.csv
2024-10-16 09:36:13,335 - INFO - ##### Adding numeric labels y
2024-10-16 09:36:13,684 - INFO - ##### Data Preprocessing...
2024-10-16 09:36:13,837 - INFO -      1.删除多余列后样本量: (501070, 277)
2024-10-16 09:36:16,031 - INFO -      2.填充缺失值后样本量: (501070, 277)
2024-10-16 09:36:16,034 - INFO -      3.清理特征名称后样本量: (501070, 277)
2024-10-16 09:36:16,035 - INFO - ##### Extracting X_train, y_train
2024-10-16 09:36:19,375 - INFO -      ->->->处理类别特征: dimension，唯一值数量: 8
2024-10-16 09:36:19,680 - INFO -      ->->->处理类别特征: ExactSearch_v_X，唯一值数量: 2
2024-10-16 09:36:19,985 - INFO -      ->->->处理类别特征: ExactSearch_X_v，唯一值数量: 2
2024-10-16 09:36:20,281 - INFO -      ->->->处理类别特征: ExactSearch_v_Y，唯一值数量: 2
2024-10-16 09:36:20,593 - INFO -      ->->->处理类别特征: ExactSearch_Y_v，唯一值数量: 2
2024-10-16 09:36:20,885 - INFO -      ->->->处理类别特征: ExactSearch_X_Y，唯一值数量: 2
2024-10-16 09:36:21,197 - INFO -      ->->->处理类别特征: PC_v_X，唯一值数量: 2
2024-10-16 09:36:21,488 - INFO -      ->->->处理类别特征: PC_X_v，唯一值数量: 2
2024-10-16 09:36:21,798 - INFO -      ->->->处理类别特征: PC_v_Y，唯一值数量: 2
2024-10-16 09:36:22,101 - INFO -      ->->->处理类别特征: PC_Y_v，唯一值数量: 2
2024-10-16 09:36:22,408 - INFO -      ->->->处理类别特征: PC_X_Y，唯一值数量: 2
2024-10-16 09:36:22,700 - INFO -      ->->->处理类别特征: FCI_v_X，唯一值数量: 4
2024-10-16 09:36:23,017 - INFO -      ->->->处理类别特征: FCI_X_v，唯一值数量: 4
2024-10-16 09:36:23,310 - INFO -      ->->->处理类别特征: FCI_v_Y，唯一值数量: 4
2024-10-16 09:36:23,620 - INFO -      ->->->处理类别特征: FCI_Y_v，唯一值数量: 4
2024-10-16 09:36:23,920 - INFO -      ->->->处理类别特征: FCI_X_Y，唯一值数量: 4
2024-10-16 09:36:24,230 - INFO -      ->->->处理类别特征: GRaSP_v_X，唯一值数量: 3
2024-10-16 09:36:24,527 - INFO -      ->->->处理类别特征: GRaSP_X_v，唯一值数量: 3
2024-10-16 09:36:24,847 - INFO -      ->->->处理类别特征: GRaSP_v_Y，唯一值数量: 3
2024-10-16 09:36:25,145 - INFO -      ->->->处理类别特征: GRaSP_Y_v，唯一值数量: 3
2024-10-16 09:36:25,461 - INFO -      ->->->处理类别特征: GRaSP_X_Y，唯一值数量: 3
2024-10-16 09:36:25,754 - INFO -      ->类别特征索引 (cat_idxs): [1, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106]
2024-10-16 09:36:25,756 - INFO -      ->类别特征模态数 (cat_dims): [8, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3]
2024-10-16 09:36:25,757 - INFO -      4.处理类别特征后样本量: (501070, 273), (501070,)
2024-10-16 09:36:25,759 - INFO - ##### Extracting X_train, y_train, and group
2024-10-16 09:36:27,596 - INFO -      5.分割数据集后样本量: (450963, 273), (50107, 273), (450963,), (50107,)
2024-10-16 09:36:27,608 - INFO -      ->y_train 唯一值: [0 1 2 3 4 5 6 7]
2024-10-16 09:36:27,611 - INFO -      ->y_test 唯一值: [0 1 2 3 4 5 6 7]
2024-10-16 09:36:27,612 - INFO - ##### Computing class weights
2024-10-16 09:36:27,675 - INFO -      ->分类目标权重列表: [3.0199493731918996, 3.280017165134412, 3.1442645582329316, 0.29599604606102614, 1.8063375204281091, 0.8411480094305838, 0.7286854147545858, 1.8091782206816869]
2024-10-16 09:36:27,677 - INFO -      ->分类目标权重字典: {0: 3.0199493731918996, 1: 3.280017165134412, 2: 3.1442645582329316, 3: 0.29599604606102614, 4: 1.8063375204281091, 5: 0.8411480094305838, 6: 0.7286854147545858, 7: 1.8091782206816869}
2024-10-16 09:36:27,682 - INFO - ##### Start training
2024-10-16 09:40:58,554 - INFO - ##### Xgb的参数配置:
2024-10-16 09:40:58,556 - INFO - {   'base_score': None,
    'booster': None,
    'callbacks': [<xgboost.callback.EarlyStopping object at 0x7f134c831710>],
    'colsample_bylevel': None,
    'colsample_bynode': None,
    'colsample_bytree': 0.7,
    'device': None,
    'early_stopping_rounds': None,
    'enable_categorical': False,
    'eval_metric': 'mlogloss',
    'feature_types': None,
    'gamma': 0.3,
    'grow_policy': None,
    'importance_type': None,
    'interaction_constraints': None,
    'learning_rate': 0.05,
    'max_bin': None,
    'max_cat_threshold': None,
    'max_cat_to_onehot': None,
    'max_delta_step': 0.5,
    'max_depth': 5,
    'max_leaves': None,
    'min_child_weight': 1,
    'missing': nan,
    'monotone_constraints': None,
    'multi_strategy': None,
    'n_estimators': 4000,
    'n_jobs': None,
    'num_class': 8,
    'num_parallel_tree': None,
    'objective': 'multi:softmax',
    'random_state': 42,
    'reg_alpha': 10,
    'reg_lambda': 10,
    'sampling_method': None,
    'scale_pos_weight': None,
    'subsample': 0.7,
    'tree_method': 'gpu_hist',
    'use_label_encoder': False,
    'validate_parameters': None,
    'verbosity': 0}
2024-10-16 09:40:58,558 - INFO - ############################
2024-10-16 09:40:58,560 - INFO -      Xgb的性能展示:
2024-10-16 09:40:58,562 - INFO - ############################
2024-10-16 09:41:12,748 - INFO -      ->训练集平衡准确率: 0.919514
2024-10-16 09:41:12,750 - INFO -      ->测试集平衡准确率: 0.757108
2024-10-16 09:41:12,751 - INFO -      ->测试集分类报告:
2024-10-16 09:41:12,820 - INFO - 
              precision    recall  f1-score   support

           0       0.60      0.69      0.64      2074
           1       0.65      0.71      0.68      1910
           2       0.58      0.65      0.61      1992
           3       0.92      0.85      0.88     21160
           4       0.62      0.75      0.68      3468
           5       0.77      0.75      0.76      7446
           6       0.85      0.85      0.85      8595
           7       0.69      0.80      0.75      3462

    accuracy                           0.80     50107
   macro avg       0.71      0.76      0.73     50107
weighted avg       0.81      0.80      0.81     50107

2024-10-16 09:41:13,388 - INFO -      5.Xgboost训练完成
2024-10-16 09:41:13,391 - INFO - ############################
2024-10-16 09:41:13,393 - INFO - 

2024-10-16 09:42:27,143 - INFO - ##### Cat的参数配置:
2024-10-16 09:42:27,145 - INFO - {   'cat_features': [   1,
                        87,
                        88,
                        89,
                        90,
                        91,
                        92,
                        93,
                        94,
                        95,
                        96,
                        97,
                        98,
                        99,
                        100,
                        101,
                        102,
                        103,
                        104,
                        105,
                        106],
    'class_weights': [   3.0199493731918996,
                         3.280017165134412,
                         3.1442645582329316,
                         0.29599604606102614,
                         1.8063375204281091,
                         0.8411480094305838,
                         0.7286854147545858,
                         1.8091782206816869],
    'classes_count': 8,
    'depth': 9,
    'devices': '0:1',
    'early_stopping_rounds': 20,
    'eval_metric': 'Accuracy',
    'iterations': 4000,
    'l2_leaf_reg': 0.3,
    'leaf_estimation_method': 'Newton',
    'learning_rate': 0.05,
    'loss_function': 'MultiClass',
    'model_size_reg': 0.3,
    'random_seed': 42,
    'save_snapshot': False,
    'task_type': 'GPU',
    'train_dir': '/tmp/catboost_info_local_test_alldata_earlystop',
    'verbose': 50}
2024-10-16 09:42:27,146 - INFO - ############################
2024-10-16 09:42:27,148 - INFO -      Cat的性能展示:
2024-10-16 09:42:27,149 - INFO - ############################
2024-10-16 09:42:29,505 - INFO -      ->训练集平衡准确率: 0.877156
2024-10-16 09:42:29,507 - INFO -      ->测试集平衡准确率: 0.736475
2024-10-16 09:42:29,509 - INFO -      ->测试集分类报告:
2024-10-16 09:42:29,584 - INFO - 
              precision    recall  f1-score   support

           0       0.57      0.68      0.62      2074
           1       0.59      0.68      0.63      1910
           2       0.55      0.64      0.59      1992
           3       0.92      0.83      0.87     21160
           4       0.59      0.74      0.66      3468
           5       0.75      0.72      0.73      7446
           6       0.84      0.83      0.83      8595
           7       0.66      0.79      0.72      3462

    accuracy                           0.78     50107
   macro avg       0.68      0.74      0.71     50107
weighted avg       0.80      0.78      0.79     50107

2024-10-16 09:42:30,178 - INFO -      6.Catboost训练完成
2024-10-16 09:42:30,181 - INFO - ############################
2024-10-16 09:42:30,183 - INFO - 

2024-10-16 09:53:24,702 - INFO - ##### Lgb的参数配置:
2024-10-16 09:53:24,704 - INFO - {   'boosting_type': 'gbdt',
    'class_weight': 'balanced',
    'colsample_bytree': 0.6,
    'device': 'cpu',
    'importance_type': 'split',
    'learning_rate': 0.05,
    'max_depth': 5,
    'min_child_samples': 50,
    'min_child_weight': 0.001,
    'min_split_gain': 0.0,
    'n_estimators': 4000,
    'n_jobs': -1,
    'num_leaves': 21,
    'objective': None,
    'random_state': 42,
    'reg_alpha': 25.0,
    'reg_lambda': 25.0,
    'subsample': 1.0,
    'subsample_for_bin': 200000,
    'subsample_freq': 0,
    'verbosity': 0}
2024-10-16 09:53:24,705 - INFO - ############################
2024-10-16 09:53:24,707 - INFO -      Lgb的性能展示:
2024-10-16 09:53:24,708 - INFO - ############################
2024-10-16 09:55:37,453 - INFO -      ->训练集平衡准确率: 0.928581
2024-10-16 09:55:37,455 - INFO -      ->测试集平衡准确率: 0.759405
2024-10-16 09:55:37,456 - INFO -      ->测试集分类报告:
2024-10-16 09:55:37,531 - INFO - 
              precision    recall  f1-score   support

           0       0.61      0.70      0.65      2074
           1       0.64      0.71      0.67      1910
           2       0.59      0.66      0.62      1992
           3       0.92      0.85      0.88     21160
           4       0.63      0.75      0.68      3468
           5       0.77      0.75      0.76      7446
           6       0.86      0.85      0.85      8595
           7       0.71      0.81      0.75      3462

    accuracy                           0.81     50107
   macro avg       0.71      0.76      0.73     50107
weighted avg       0.82      0.81      0.81     50107

2024-10-16 09:55:37,953 - INFO -      7.LightGBM训练完成
2024-10-16 09:55:37,955 - INFO - ############################
2024-10-16 09:55:37,956 - INFO - 

2024-10-16 09:55:37,957 - INFO -      Voting的性能展示:
2024-10-16 09:55:37,958 - INFO - ############################
2024-10-16 09:58:05,569 - INFO -      ->训练集平衡准确率: 0.917748
2024-10-16 09:58:05,572 - INFO -      ->测试集平衡准确率: 0.758589
2024-10-16 09:58:05,573 - INFO -      ->测试集分类报告:
2024-10-16 09:58:05,645 - INFO - 
              precision    recall  f1-score   support

           0       0.61      0.70      0.65      2074
           1       0.64      0.71      0.67      1910
           2       0.59      0.66      0.62      1992
           3       0.92      0.85      0.88     21160
           4       0.62      0.75      0.68      3468
           5       0.77      0.75      0.76      7446
           6       0.86      0.85      0.85      8595
           7       0.69      0.81      0.75      3462

    accuracy                           0.80     50107
   macro avg       0.71      0.76      0.73     50107
weighted avg       0.82      0.80      0.81     50107

2024-10-16 09:58:05,646 - INFO -      8.Voting检查完成
2024-10-16 09:58:05,647 - INFO - ############################
2024-10-16 09:58:05,649 - INFO - 

2024-10-16 09:58:05,838 - INFO - Loading /tmp/X_group_test_local_test_alldata_earlystop.csv
2024-10-16 09:58:06,228 - INFO - ##### Loading Models...
2024-10-16 09:58:07,377 - INFO - ##### Data Preprocessing...
2024-10-16 09:58:07,382 - INFO -      1.删除多余列后样本量: (11486, 275)
2024-10-16 09:58:07,497 - INFO -      2.填充缺失值后样本量: (11486, 275)
2024-10-16 09:58:07,500 - INFO -      3.清理特征名称后样本量: (11486, 275)
2024-10-16 09:58:07,502 - INFO - ##### Extracting X_test
2024-10-16 09:58:07,611 - INFO -      ->->->处理类别特征: dimension，唯一值数量: 8
2024-10-16 09:58:07,619 - INFO -      ->->->处理类别特征: ExactSearch_v_X，唯一值数量: 2
2024-10-16 09:58:07,626 - INFO -      ->->->处理类别特征: ExactSearch_X_v，唯一值数量: 2
2024-10-16 09:58:07,636 - INFO -      ->->->处理类别特征: ExactSearch_v_Y，唯一值数量: 2
2024-10-16 09:58:07,645 - INFO -      ->->->处理类别特征: ExactSearch_Y_v，唯一值数量: 2
2024-10-16 09:58:07,651 - INFO -      ->->->处理类别特征: ExactSearch_X_Y，唯一值数量: 2
2024-10-16 09:58:07,657 - INFO -      ->->->处理类别特征: PC_v_X，唯一值数量: 2
2024-10-16 09:58:07,663 - INFO -      ->->->处理类别特征: PC_X_v，唯一值数量: 2
2024-10-16 09:58:07,669 - INFO -      ->->->处理类别特征: PC_v_Y，唯一值数量: 2
2024-10-16 09:58:07,675 - INFO -      ->->->处理类别特征: PC_Y_v，唯一值数量: 2
2024-10-16 09:58:07,681 - INFO -      ->->->处理类别特征: PC_X_Y，唯一值数量: 2
2024-10-16 09:58:07,688 - INFO -      ->->->处理类别特征: FCI_v_X，唯一值数量: 4
2024-10-16 09:58:07,695 - INFO -      ->->->处理类别特征: FCI_X_v，唯一值数量: 4
2024-10-16 09:58:07,701 - INFO -      ->->->处理类别特征: FCI_v_Y，唯一值数量: 4
2024-10-16 09:58:07,707 - INFO -      ->->->处理类别特征: FCI_Y_v，唯一值数量: 4
2024-10-16 09:58:07,713 - INFO -      ->->->处理类别特征: FCI_X_Y，唯一值数量: 4
2024-10-16 09:58:07,719 - INFO -      ->->->处理类别特征: GRaSP_v_X，唯一值数量: 3
2024-10-16 09:58:07,725 - INFO -      ->->->处理类别特征: GRaSP_X_v，唯一值数量: 3
2024-10-16 09:58:07,731 - INFO -      ->->->处理类别特征: GRaSP_v_Y，唯一值数量: 3
2024-10-16 09:58:07,737 - INFO -      ->->->处理类别特征: GRaSP_Y_v，唯一值数量: 3
2024-10-16 09:58:07,743 - INFO -      ->->->处理类别特征: GRaSP_X_Y，唯一值数量: 3
2024-10-16 09:58:07,749 - INFO -      ->类别特征索引 (cat_idxs): [1, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106]
2024-10-16 09:58:07,750 - INFO -      ->类别特征模态数 (cat_dims): [8, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 3, 3, 3, 3, 3]
2024-10-16 09:58:07,751 - INFO -      4.处理类别特征后样本量: (11486, 273)
2024-10-16 09:58:07,754 - INFO - 测试数据类型为 DataFrame
2024-10-16 09:58:07,773 - INFO - 测试数据类型为 DataFrame
2024-10-16 09:58:07,789 - INFO -      5.对齐特征后样本量: (11486, 273)
2024-10-16 09:58:07,790 - INFO - ##### Predicting on X_test
2024-10-16 09:58:16,054 - INFO - 预测完成
2024-10-16 09:58:16,244 - INFO - submission文件已保存
